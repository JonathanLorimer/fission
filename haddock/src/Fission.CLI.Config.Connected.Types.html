<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Fission.CLI.Config.Connected.Types</span><span>
</span><span id="line-2"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Fission.CLI.Config.Connected.Types.html#ConnectedConfig"><span class="hs-identifier">ConnectedConfig</span></a></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-3"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.CLI.Config.Connected.Types.html#FissionConnected"><span class="hs-identifier">FissionConnected</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-4"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Catch</span></span><span>
</span><span id="line-7"></span><span> </span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">RIO.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Lazy</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">RIO.Text</span></span><span>            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.Ed25519</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ed25519</span></span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Network.HTTP.Client</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HTTP</span></span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Network.IPFS</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Network.IPFS.Types</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IPFS</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.IPFS.Process.Error</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Process</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Network.IPFS.Process</span></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Servant.Client</span></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Fission.Prelude.html"><span class="hs-identifier">Fission.Prelude</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Fission.Authorization.ServerDID.html"><span class="hs-identifier">Fission.Authorization.ServerDID</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Fission.User.DID.Types.html"><span class="hs-identifier">Fission.User.DID.Types</span></a></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Fission.Web.Auth.Token.html"><span class="hs-identifier">Fission.Web.Auth.Token</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Fission.Web.Auth.Token.Bearer.Types.html"><span class="hs-identifier">Fission.Web.Auth.Token.Bearer.Types</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bearer</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Fission.Web.Auth.Token.JWT.html"><span class="hs-identifier">Fission.Web.Auth.Token.JWT</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">JWT</span></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Fission.Web.Client.html"><span class="hs-identifier">Fission.Web.Client</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Fission.Web.Client.JWT.html"><span class="hs-identifier">Fission.Web.Client.JWT</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">JWT</span></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Fission.CLI.Environment.Class.html"><span class="hs-identifier">Fission.CLI.Environment.Class</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">data</span><span> </span><span id="ConnectedConfig"><span class="annot"><a href="Fission.CLI.Config.Connected.Types.html#ConnectedConfig"><span class="hs-identifier hs-var">ConnectedConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ConnectedConfig"><span class="annot"><a href="Fission.CLI.Config.Connected.Types.html#ConnectedConfig"><span class="hs-identifier hs-var">ConnectedConfig</span></a></span></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AhttpManager%3AConnectedConfig"><span class="annot"><span class="annottext">ConnectedConfig -&gt; Manager
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AhttpManager%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">httpManager</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">HTTP.Manager</span></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AsecretKey%3AConnectedConfig"><span class="annot"><span class="annottext">ConnectedConfig -&gt; SecretKey
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AsecretKey%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">secretKey</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Ed25519.SecretKey</span></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AcliDID%3AConnectedConfig"><span class="annot"><span class="annottext">ConnectedConfig -&gt; DID
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AcliDID%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">cliDID</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Fission.User.DID.Types.html#DID"><span class="hs-identifier hs-type">DID</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AserverDID%3AConnectedConfig"><span class="annot"><span class="annottext">ConnectedConfig -&gt; DID
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AserverDID%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">serverDID</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Fission.User.DID.Types.html#DID"><span class="hs-identifier hs-type">DID</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-comment">-- TODO link systems, ucanLink     :: !JWT</span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AfissionURL%3AConnectedConfig"><span class="annot"><span class="annottext">ConnectedConfig -&gt; BaseUrl
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AfissionURL%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">fissionURL</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">BaseUrl</span></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AlogFunc%3AConnectedConfig"><span class="annot"><span class="annottext">ConnectedConfig -&gt; LogFunc
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AlogFunc%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">logFunc</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">LogFunc</span></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AprocessCtx%3AConnectedConfig"><span class="annot"><span class="annottext">ConnectedConfig -&gt; ProcessContext
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AprocessCtx%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">processCtx</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">ProcessContext</span></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AipfsPath%3AConnectedConfig"><span class="annot"><span class="annottext">ConnectedConfig -&gt; BinPath
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AipfsPath%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">ipfsPath</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">IPFS.BinPath</span></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AipfsTimeout%3AConnectedConfig"><span class="annot"><span class="annottext">ConnectedConfig -&gt; Timeout
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AipfsTimeout%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">ipfsTimeout</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">IPFS.Timeout</span></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Apeer%3AConnectedConfig"><span class="annot"><span class="annottext">ConnectedConfig -&gt; Peer
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3Apeer%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">peer</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">IPFS.Peer</span></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AignoredFiles%3AConnectedConfig"><span class="annot"><span class="annottext">ConnectedConfig -&gt; Ignored
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AignoredFiles%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">ignoredFiles</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">IPFS.Ignored</span></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasProcessContext</span></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Connected.Types.html#ConnectedConfig"><span class="hs-identifier hs-type">ConnectedConfig</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>  </span><span id="local-6989586621680313697"><span class="annot"><span class="annottext">processContextL :: (ProcessContext -&gt; f ProcessContext)
-&gt; ConnectedConfig -&gt; f ConnectedConfig
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">processContextL</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConnectedConfig -&gt; ProcessContext)
-&gt; (ConnectedConfig -&gt; ProcessContext -&gt; ConnectedConfig)
-&gt; Lens' ConnectedConfig ProcessContext
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">ConnectedConfig -&gt; ProcessContext
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AprocessCtx%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">processCtx</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680313694"><span class="annot"><span class="annottext">cfg :: ConnectedConfig
</span><a href="#local-6989586621680313694"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621680313693"><span class="annot"><span class="annottext">newProcessCtx :: ProcessContext
</span><a href="#local-6989586621680313693"><span class="hs-identifier hs-var">newProcessCtx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><span class="annottext">ConnectedConfig
</span><a href="#local-6989586621680313694"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:processCtx:ConnectedConfig :: ProcessContext
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AprocessCtx%3AConnectedConfig"><span class="hs-identifier hs-var">processCtx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProcessContext
</span><a href="#local-6989586621680313693"><span class="hs-identifier hs-var">newProcessCtx</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasLogFunc</span></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Connected.Types.html#ConnectedConfig"><span class="hs-identifier hs-type">ConnectedConfig</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>  </span><span id="local-6989586621680313690"><span class="annot"><span class="annottext">logFuncL :: (LogFunc -&gt; f LogFunc) -&gt; ConnectedConfig -&gt; f ConnectedConfig
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">logFuncL</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConnectedConfig -&gt; LogFunc)
-&gt; (ConnectedConfig -&gt; LogFunc -&gt; ConnectedConfig)
-&gt; Lens' ConnectedConfig LogFunc
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">ConnectedConfig -&gt; LogFunc
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AlogFunc%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">logFunc</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680313688"><span class="annot"><span class="annottext">cfg :: ConnectedConfig
</span><a href="#local-6989586621680313688"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621680313687"><span class="annot"><span class="annottext">newLogFunc' :: LogFunc
</span><a href="#local-6989586621680313687"><span class="hs-identifier hs-var">newLogFunc'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><span class="annottext">ConnectedConfig
</span><a href="#local-6989586621680313688"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:logFunc:ConnectedConfig :: LogFunc
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AlogFunc%3AConnectedConfig"><span class="hs-identifier hs-var">logFunc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LogFunc
</span><a href="#local-6989586621680313687"><span class="hs-identifier hs-var">newLogFunc'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | The top-level app type</span><span>
</span><span id="line-59"></span><span class="hs-keyword">newtype</span><span> </span><span id="FissionConnected"><span class="annot"><a href="Fission.CLI.Config.Connected.Types.html#FissionConnected"><span class="hs-identifier hs-var">FissionConnected</span></a></span></span><span> </span><span id="local-6989586621680313777"><span class="annot"><a href="#local-6989586621680313777"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FissionConnected"><span class="annot"><a href="Fission.CLI.Config.Connected.Types.html#FissionConnected"><span class="hs-identifier hs-var">FissionConnected</span></a></span></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AunwrapFissionConnected%3AFissionConnected"><span class="annot"><span class="annottext">FissionConnected a -&gt; RIO ConnectedConfig a
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AunwrapFissionConnected%3AFissionConnected"><span class="hs-identifier hs-var hs-var">unwrapFissionConnected</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RIO</span></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Connected.Types.html#ConnectedConfig"><span class="hs-identifier hs-type">ConnectedConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680313777"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span> </span><span id="local-6989586621680313681"><span id="local-6989586621680313683"><span class="annot"><span class="annottext">a -&gt; FissionConnected b -&gt; FissionConnected a
(a -&gt; b) -&gt; FissionConnected a -&gt; FissionConnected b
(forall a b. (a -&gt; b) -&gt; FissionConnected a -&gt; FissionConnected b)
-&gt; (forall a b. a -&gt; FissionConnected b -&gt; FissionConnected a)
-&gt; Functor FissionConnected
forall a b. a -&gt; FissionConnected b -&gt; FissionConnected a
forall a b. (a -&gt; b) -&gt; FissionConnected a -&gt; FissionConnected b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; FissionConnected b -&gt; FissionConnected a
$c&lt;$ :: forall a b. a -&gt; FissionConnected b -&gt; FissionConnected a
fmap :: (a -&gt; b) -&gt; FissionConnected a -&gt; FissionConnected b
$cfmap :: forall a b. (a -&gt; b) -&gt; FissionConnected a -&gt; FissionConnected b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span>
</span><span id="line-62"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680313669"><span id="local-6989586621680313671"><span id="local-6989586621680313673"><span id="local-6989586621680313675"><span id="local-6989586621680313677"><span class="annot"><span class="annottext">Functor FissionConnected
a -&gt; FissionConnected a
Functor FissionConnected =&gt;
(forall a. a -&gt; FissionConnected a)
-&gt; (forall a b.
    FissionConnected (a -&gt; b)
    -&gt; FissionConnected a -&gt; FissionConnected b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c)
    -&gt; FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected c)
-&gt; (forall a b.
    FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected b)
-&gt; (forall a b.
    FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected a)
-&gt; Applicative FissionConnected
FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected b
FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected a
FissionConnected (a -&gt; b)
-&gt; FissionConnected a -&gt; FissionConnected b
(a -&gt; b -&gt; c)
-&gt; FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected c
forall a. a -&gt; FissionConnected a
forall a b.
FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected a
forall a b.
FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected b
forall a b.
FissionConnected (a -&gt; b)
-&gt; FissionConnected a -&gt; FissionConnected b
forall a b c.
(a -&gt; b -&gt; c)
-&gt; FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected a
$c&lt;* :: forall a b.
FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected a
*&gt; :: FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected b
$c*&gt; :: forall a b.
FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected b
liftA2 :: (a -&gt; b -&gt; c)
-&gt; FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected c
$cliftA2 :: forall a b c.
(a -&gt; b -&gt; c)
-&gt; FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected c
&lt;*&gt; :: FissionConnected (a -&gt; b)
-&gt; FissionConnected a -&gt; FissionConnected b
$c&lt;*&gt; :: forall a b.
FissionConnected (a -&gt; b)
-&gt; FissionConnected a -&gt; FissionConnected b
pure :: a -&gt; FissionConnected a
$cpure :: forall a. a -&gt; FissionConnected a
$cp1Applicative :: Functor FissionConnected
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span>
</span><span id="line-63"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680313661"><span id="local-6989586621680313663"><span id="local-6989586621680313665"><span class="annot"><span class="annottext">Applicative FissionConnected
a -&gt; FissionConnected a
Applicative FissionConnected =&gt;
(forall a b.
 FissionConnected a
 -&gt; (a -&gt; FissionConnected b) -&gt; FissionConnected b)
-&gt; (forall a b.
    FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected b)
-&gt; (forall a. a -&gt; FissionConnected a)
-&gt; Monad FissionConnected
FissionConnected a
-&gt; (a -&gt; FissionConnected b) -&gt; FissionConnected b
FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected b
forall a. a -&gt; FissionConnected a
forall a b.
FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected b
forall a b.
FissionConnected a
-&gt; (a -&gt; FissionConnected b) -&gt; FissionConnected b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: a -&gt; FissionConnected a
$creturn :: forall a. a -&gt; FissionConnected a
&gt;&gt; :: FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected b
$c&gt;&gt; :: forall a b.
FissionConnected a -&gt; FissionConnected b -&gt; FissionConnected b
&gt;&gt;= :: FissionConnected a
-&gt; (a -&gt; FissionConnected b) -&gt; FissionConnected b
$c&gt;&gt;= :: forall a b.
FissionConnected a
-&gt; (a -&gt; FissionConnected b) -&gt; FissionConnected b
$cp1Monad :: Applicative FissionConnected
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span>
</span><span id="line-64"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680313657"><span class="annot"><span class="annottext">Monad FissionConnected
Monad FissionConnected =&gt;
(forall a. IO a -&gt; FissionConnected a) -&gt; MonadIO FissionConnected
IO a -&gt; FissionConnected a
forall a. IO a -&gt; FissionConnected a
forall (m :: * -&gt; *).
Monad m =&gt;
(forall a. IO a -&gt; m a) -&gt; MonadIO m
liftIO :: IO a -&gt; FissionConnected a
$cliftIO :: forall a. IO a -&gt; FissionConnected a
$cp1MonadIO :: Monad FissionConnected
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadIO</span></span></span><span>
</span><span id="line-65"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680313651"><span id="local-6989586621680313653"><span class="annot"><span class="annottext">MonadIO FissionConnected
FissionConnected (UnliftIO FissionConnected)
MonadIO FissionConnected =&gt;
FissionConnected (UnliftIO FissionConnected)
-&gt; (forall b.
    ((forall a. FissionConnected a -&gt; IO a) -&gt; IO b)
    -&gt; FissionConnected b)
-&gt; MonadUnliftIO FissionConnected
((forall a. FissionConnected a -&gt; IO a) -&gt; IO b)
-&gt; FissionConnected b
forall b.
((forall a. FissionConnected a -&gt; IO a) -&gt; IO b)
-&gt; FissionConnected b
forall (m :: * -&gt; *).
MonadIO m =&gt;
m (UnliftIO m)
-&gt; (forall b. ((forall a. m a -&gt; IO a) -&gt; IO b) -&gt; m b)
-&gt; MonadUnliftIO m
withRunInIO :: ((forall a. FissionConnected a -&gt; IO a) -&gt; IO b)
-&gt; FissionConnected b
$cwithRunInIO :: forall b.
((forall a. FissionConnected a -&gt; IO a) -&gt; IO b)
-&gt; FissionConnected b
askUnliftIO :: FissionConnected (UnliftIO FissionConnected)
$caskUnliftIO :: FissionConnected (UnliftIO FissionConnected)
$cp1MonadUnliftIO :: MonadIO FissionConnected
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadUnliftIO</span></span></span></span><span>
</span><span id="line-66"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680313643"><span id="local-6989586621680313645"><span id="local-6989586621680313647"><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Connected.Types.html#ConnectedConfig"><span class="hs-identifier hs-type">ConnectedConfig</span></a></span></span></span></span><span>
</span><span id="line-67"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680313639"><span class="annot"><span class="annottext">Monad FissionConnected
e -&gt; FissionConnected a
Monad FissionConnected =&gt;
(forall e a. Exception e =&gt; e -&gt; FissionConnected a)
-&gt; MonadThrow FissionConnected
forall e a. Exception e =&gt; e -&gt; FissionConnected a
forall (m :: * -&gt; *).
Monad m =&gt;
(forall e a. Exception e =&gt; e -&gt; m a) -&gt; MonadThrow m
throwM :: e -&gt; FissionConnected a
$cthrowM :: forall e a. Exception e =&gt; e -&gt; FissionConnected a
$cp1MonadThrow :: Monad FissionConnected
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadThrow</span></span></span><span>
</span><span id="line-68"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680313635"><span class="annot"><span class="annottext">MonadThrow FissionConnected
MonadThrow FissionConnected =&gt;
(forall e a.
 Exception e =&gt;
 FissionConnected a
 -&gt; (e -&gt; FissionConnected a) -&gt; FissionConnected a)
-&gt; MonadCatch FissionConnected
FissionConnected a
-&gt; (e -&gt; FissionConnected a) -&gt; FissionConnected a
forall e a.
Exception e =&gt;
FissionConnected a
-&gt; (e -&gt; FissionConnected a) -&gt; FissionConnected a
forall (m :: * -&gt; *).
MonadThrow m =&gt;
(forall e a. Exception e =&gt; m a -&gt; (e -&gt; m a) -&gt; m a)
-&gt; MonadCatch m
catch :: FissionConnected a
-&gt; (e -&gt; FissionConnected a) -&gt; FissionConnected a
$ccatch :: forall e a.
Exception e =&gt;
FissionConnected a
-&gt; (e -&gt; FissionConnected a) -&gt; FissionConnected a
$cp1MonadCatch :: MonadThrow FissionConnected
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadCatch</span></span></span><span>
</span><span id="line-69"></span><span>                   </span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadLogger</span></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Connected.Types.html#FissionConnected"><span class="hs-identifier hs-type">FissionConnected</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>  </span><span id="local-6989586621680313630"><span class="annot"><span class="annottext">monadLoggerLog :: Loc -&gt; LogSource -&gt; LogLevel -&gt; msg -&gt; FissionConnected ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">monadLoggerLog</span></span></span><span> </span><span id="local-6989586621680313628"><span class="annot"><span class="annottext">loc :: Loc
</span><a href="#local-6989586621680313628"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621680313627"><span class="annot"><span class="annottext">src :: LogSource
</span><a href="#local-6989586621680313627"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621680313626"><span class="annot"><span class="annottext">lvl :: LogLevel
</span><a href="#local-6989586621680313626"><span class="hs-identifier hs-var">lvl</span></a></span></span><span> </span><span id="local-6989586621680313625"><span class="annot"><span class="annottext">msg :: msg
</span><a href="#local-6989586621680313625"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><span class="annottext">RIO ConnectedConfig () -&gt; FissionConnected ()
forall a. RIO ConnectedConfig a -&gt; FissionConnected a
</span><a href="Fission.CLI.Config.Connected.Types.html#FissionConnected"><span class="hs-identifier hs-var">FissionConnected</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Loc -&gt; LogSource -&gt; LogLevel -&gt; msg -&gt; RIO ConnectedConfig ()
forall (m :: * -&gt; *) msg.
(MonadLogger m, ToLogStr msg) =&gt;
Loc -&gt; LogSource -&gt; LogLevel -&gt; msg -&gt; m ()
</span><span class="hs-identifier hs-var">monadLoggerLog</span></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621680313628"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">LogSource
</span><a href="#local-6989586621680313627"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="#local-6989586621680313626"><span class="hs-identifier hs-var">lvl</span></a></span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621680313625"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadLocalIPFS</span></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Connected.Types.html#FissionConnected"><span class="hs-identifier hs-type">FissionConnected</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>  </span><span id="local-6989586621680313621"><span class="annot"><span class="annottext">runLocal :: [Opt] -&gt; ByteString -&gt; FissionConnected (Either Error ByteString)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">runLocal</span></span></span><span> </span><span id="local-6989586621680313619"><span class="annot"><span class="annottext">opts :: [Opt]
</span><a href="#local-6989586621680313619"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621680313618"><span class="annot"><span class="annottext">arg :: ByteString
</span><a href="#local-6989586621680313618"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">IPFS.BinPath</span></span><span> </span><span id="local-6989586621680313616"><span class="annot"><span class="annottext">ipfs :: Opt
</span><a href="#local-6989586621680313616"><span class="hs-identifier hs-var">ipfs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ConnectedConfig -&gt; BinPath) -&gt; FissionConnected BinPath
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">ConnectedConfig -&gt; BinPath
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AipfsPath%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">ipfsPath</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">IPFS.Timeout</span></span><span> </span><span id="local-6989586621680313613"><span class="annot"><span class="annottext">secs :: Natural
</span><a href="#local-6989586621680313613"><span class="hs-identifier hs-var">secs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ConnectedConfig -&gt; Timeout) -&gt; FissionConnected Timeout
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">ConnectedConfig -&gt; Timeout
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AipfsTimeout%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">ipfsTimeout</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680313612"><span class="annot"><span class="annottext">opts' :: [Opt]
</span><a href="#local-6989586621680313612"><span class="hs-identifier hs-var hs-var">opts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;--timeout=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Opt -&gt; Opt -&gt; Opt
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Opt
forall a. Show a =&gt; a -&gt; Opt
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621680313613"><span class="hs-identifier hs-var">secs</span></a></span><span> </span><span class="annot"><span class="annottext">Opt -&gt; Opt -&gt; Opt
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;s&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Opt -&gt; [Opt] -&gt; [Opt]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Opt]
</span><a href="#local-6989586621680313619"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><span class="annottext">(ProcessConfig () (STM ByteString) ()
 -&gt; FissionConnected (ExitCode, ByteString, ByteString))
-&gt; Opt
-&gt; StreamIn ()
-&gt; StreamOut (STM ByteString)
-&gt; [Opt]
-&gt; FissionConnected (ExitCode, ByteString, ByteString)
forall (m :: * -&gt; *) cfg stdin stdout a.
(MonadIO m, MonadReader cfg m, HasProcessContext cfg,
 HasLogFunc cfg) =&gt;
(ProcessConfig stdin stdout () -&gt; m a)
-&gt; Opt -&gt; StreamIn stdin -&gt; StreamOut stdout -&gt; [Opt] -&gt; m a
</span><span class="hs-identifier hs-var">runProc</span></span><span> </span><span class="annot"><span class="annottext">ProcessConfig () (STM ByteString) ()
-&gt; FissionConnected (ExitCode, ByteString, ByteString)
forall (m :: * -&gt; *) stdin stdoutIgnored stderrIgnored.
MonadIO m =&gt;
ProcessConfig stdin stdoutIgnored stderrIgnored
-&gt; m (ExitCode, ByteString, ByteString)
</span><span class="hs-identifier hs-var">readProcess</span></span><span> </span><span class="annot"><span class="annottext">Opt
</span><a href="#local-6989586621680313616"><span class="hs-identifier hs-var">ipfs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; StreamIn ()
</span><span class="hs-identifier hs-var">byteStringInput</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680313618"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StreamOut (STM ByteString)
</span><span class="hs-identifier hs-var">byteStringOutput</span></span><span> </span><span class="annot"><span class="annottext">[Opt]
</span><a href="#local-6989586621680313612"><span class="hs-identifier hs-var">opts'</span></a></span><span> </span><span class="annot"><span class="annottext">FissionConnected (ExitCode, ByteString, ByteString)
-&gt; ((ExitCode, ByteString, ByteString) -&gt; Either Error ByteString)
-&gt; FissionConnected (Either Error ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-83"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExitSuccess</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680313604"><span class="annot"><span class="annottext">contents :: ByteString
</span><a href="#local-6989586621680313604"><span class="hs-identifier hs-var">contents</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-84"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; Either Error ByteString
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680313604"><span class="hs-identifier hs-var">contents</span></a></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExitFailure</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680313602"><span class="annot"><span class="annottext">stdErr :: ByteString
</span><a href="#local-6989586621680313602"><span class="hs-identifier hs-var">stdErr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">Lazy.isSuffixOf</span></span><span> </span><span class="annot"><span class="hs-string">&quot;context deadline exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680313602"><span class="hs-identifier hs-var">stdErr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-88"></span><span>            </span><span class="annot"><span class="annottext">Error -&gt; Either Error ByteString
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Error -&gt; Either Error ByteString)
-&gt; Error -&gt; Either Error ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Error
</span><span class="hs-identifier hs-var">Process.Timeout</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621680313613"><span class="hs-identifier hs-var">secs</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-91"></span><span>            </span><span class="annot"><span class="annottext">Error -&gt; Either Error ByteString
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Error -&gt; Either Error ByteString)
-&gt; Error -&gt; Either Error ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Error
</span><span class="hs-identifier hs-var">Process.UnknownErr</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680313602"><span class="hs-identifier hs-var">stdErr</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Fission.CLI.Environment.Class.html#MonadEnvironment"><span class="hs-identifier hs-type">MonadEnvironment</span></a></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Connected.Types.html#FissionConnected"><span class="hs-identifier hs-type">FissionConnected</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>  </span><span id="local-6989586621680313595"><span class="annot"><span class="annottext">getIgnoredFiles :: FissionConnected Ignored
</span><a href="Fission.CLI.Environment.Class.html#getIgnoredFiles"><span class="hs-identifier hs-var hs-var hs-var hs-var">getIgnoredFiles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConnectedConfig -&gt; Ignored) -&gt; FissionConnected Ignored
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">ConnectedConfig -&gt; Ignored
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AignoredFiles%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">ignoredFiles</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Fission.Web.Client.Class.html#MonadWebClient"><span class="hs-identifier hs-type">MonadWebClient</span></a></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Connected.Types.html#FissionConnected"><span class="hs-identifier hs-type">FissionConnected</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621680313590"><span class="annot"><span class="annottext">sendRequest :: ClientM a -&gt; FissionConnected (Either ClientError a)
</span><a href="Fission.Web.Client.Class.html#sendRequest"><span class="hs-identifier hs-var hs-var hs-var hs-var">sendRequest</span></a></span></span><span> </span><span id="local-6989586621680313588"><span class="annot"><span class="annottext">req :: ClientM a
</span><a href="#local-6989586621680313588"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-98"></span><span>    </span><span id="local-6989586621680313587"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621680313587"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ConnectedConfig -&gt; Manager) -&gt; FissionConnected Manager
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">ConnectedConfig -&gt; Manager
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AhttpManager%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">httpManager</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span id="local-6989586621680313586"><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621680313586"><span class="hs-identifier hs-var">baseUrl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ConnectedConfig -&gt; BaseUrl) -&gt; FissionConnected BaseUrl
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">ConnectedConfig -&gt; BaseUrl
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AfissionURL%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">fissionURL</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="annottext">IO (Either ClientError a)
-&gt; FissionConnected (Either ClientError a)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either ClientError a)
 -&gt; FissionConnected (Either ClientError a))
-&gt; (ClientEnv -&gt; IO (Either ClientError a))
-&gt; ClientEnv
-&gt; FissionConnected (Either ClientError a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ClientM a -&gt; ClientEnv -&gt; IO (Either ClientError a)
forall a. ClientM a -&gt; ClientEnv -&gt; IO (Either ClientError a)
</span><span class="hs-identifier hs-var">runClientM</span></span><span> </span><span class="annot"><span class="annottext">ClientM a
</span><a href="#local-6989586621680313588"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">(ClientEnv -&gt; FissionConnected (Either ClientError a))
-&gt; ClientEnv -&gt; FissionConnected (Either ClientError a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Manager -&gt; BaseUrl -&gt; ClientEnv
</span><span class="hs-identifier hs-var">mkClientEnv</span></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621680313587"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621680313586"><span class="hs-identifier hs-var">baseUrl</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Fission.Web.Client.Auth.Class.html#MonadWebAuth"><span class="hs-identifier hs-type">MonadWebAuth</span></a></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Connected.Types.html#FissionConnected"><span class="hs-identifier hs-type">FissionConnected</span></a></span><span> </span><span class="annot"><a href="Fission.User.DID.Types.html#DID"><span class="hs-identifier hs-type">DID</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-104"></span><span>  </span><span id="local-6989586621680313578"><span class="annot"><span class="annottext">getAuth :: FissionConnected DID
</span><a href="Fission.Web.Client.Auth.Class.html#getAuth"><span class="hs-identifier hs-var hs-var hs-var hs-var">getAuth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConnectedConfig -&gt; DID) -&gt; FissionConnected DID
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">ConnectedConfig -&gt; DID
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AcliDID%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">cliDID</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- TODO future PR</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- i.e. A UCAN proof</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- instance MonadWebAuth FissionConnected JWT where</span><span>
</span><span id="line-109"></span><span class="hs-comment">--   getAuth = asks ucanLink</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadTime</span></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Connected.Types.html#FissionConnected"><span class="hs-identifier hs-type">FissionConnected</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-112"></span><span>  </span><span id="local-6989586621680313573"><span class="annot"><span class="annottext">currentTime :: FissionConnected UTCTime
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">currentTime</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO UTCTime -&gt; FissionConnected UTCTime
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO UTCTime
forall (m :: * -&gt; *). MonadIO m =&gt; m UTCTime
</span><span class="hs-identifier hs-var">getCurrentTime</span></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Fission.Web.Client.Auth.Class.html#MonadWebAuth"><span class="hs-identifier hs-type">MonadWebAuth</span></a></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Connected.Types.html#FissionConnected"><span class="hs-identifier hs-type">FissionConnected</span></a></span><span> </span><span class="annot"><a href="Fission.Web.Auth.Token.Types.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-115"></span><span>  </span><span id="local-6989586621680313568"><span class="annot"><span class="annottext">getAuth :: FissionConnected Token
</span><a href="#local-6989586621680313568"><span class="hs-identifier hs-var hs-var hs-var hs-var">getAuth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-116"></span><span>    </span><span id="local-6989586621680313567"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621680313567"><span class="hs-identifier hs-var">now</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FissionConnected UTCTime
forall (m :: * -&gt; *). MonadTime m =&gt; m UTCTime
</span><span class="hs-identifier hs-var">currentTime</span></span><span>
</span><span id="line-117"></span><span>    </span><span id="local-6989586621680313566"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621680313566"><span class="hs-identifier hs-var">sk</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FissionConnected SecretKey
forall (m :: * -&gt; *) auth. MonadWebAuth m auth =&gt; m auth
</span><a href="Fission.Web.Client.Auth.Class.html#getAuth"><span class="hs-identifier hs-var">getAuth</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span id="local-6989586621680313565"><span class="annot"><span class="annottext">DID
</span><a href="#local-6989586621680313565"><span class="hs-identifier hs-var">serverDID</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FissionConnected DID
forall (m :: * -&gt; *). ServerDID m =&gt; m DID
</span><a href="Fission.Authorization.ServerDID.Class.html#getServerDID"><span class="hs-identifier hs-var">getServerDID</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-121"></span><span>      </span><span id="local-6989586621680313563"><span class="annot"><span class="annottext">jwt :: JWT
</span><a href="#local-6989586621680313563"><span class="hs-identifier hs-var hs-var">jwt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><span class="annottext">UTCTime -&gt; DID -&gt; SecretKey -&gt; Proof -&gt; JWT
</span><a href="Fission.Web.Client.JWT.html#ucan"><span class="hs-identifier hs-var">JWT.ucan</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621680313567"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="annot"><span class="annottext">DID
</span><a href="#local-6989586621680313565"><span class="hs-identifier hs-var">serverDID</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621680313566"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="annot"><span class="annottext">Proof
</span><a href="Fission.Web.Auth.Token.JWT.html#RootCredential"><span class="hs-identifier hs-var">RootCredential</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span>      </span><span id="local-6989586621680313560"><span class="annot"><span class="annottext">rawContent :: RawContent
</span><a href="#local-6989586621680313560"><span class="hs-identifier hs-var hs-var">rawContent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-125"></span><span>        </span><span class="annot"><span class="annottext">JWT
</span><a href="#local-6989586621680313563"><span class="hs-identifier hs-var">jwt</span></a></span><span>
</span><span id="line-126"></span><span>          </span><span class="annot"><span class="annottext">JWT -&gt; (JWT -&gt; ByteString) -&gt; ByteString
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">JWT -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encode</span></span><span>
</span><span id="line-127"></span><span>          </span><span class="annot"><span class="annottext">ByteString -&gt; (ByteString -&gt; ByteString) -&gt; ByteString
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">Lazy.toStrict</span></span><span>
</span><span id="line-128"></span><span>          </span><span class="annot"><span class="annottext">ByteString -&gt; (ByteString -&gt; LogSource) -&gt; LogSource
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; LogSource
</span><span class="hs-identifier hs-var">decodeUtf8Lenient</span></span><span>
</span><span id="line-129"></span><span>          </span><span class="annot"><span class="annottext">LogSource -&gt; (LogSource -&gt; LogSource) -&gt; LogSource
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">LogSource -&gt; LogSource -&gt; LogSource
</span><span class="hs-identifier hs-var">Text.dropPrefix</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\&quot;&quot;</span></span><span>
</span><span id="line-130"></span><span>          </span><span class="annot"><span class="annottext">LogSource -&gt; (LogSource -&gt; LogSource) -&gt; LogSource
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">LogSource -&gt; LogSource -&gt; LogSource
</span><span class="hs-identifier hs-var">Text.dropSuffix</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\&quot;&quot;</span></span><span>
</span><span id="line-131"></span><span>          </span><span class="annot"><span class="annottext">LogSource -&gt; (LogSource -&gt; RawContent) -&gt; RawContent
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">LogSource -&gt; RawContent
</span><a href="Fission.Web.Auth.Token.JWT.RawContent.html#contentOf"><span class="hs-identifier hs-var">JWT.contentOf</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><span class="annottext">Token -&gt; FissionConnected Token
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Token -&gt; FissionConnected Token)
-&gt; Token -&gt; FissionConnected Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Token
</span><a href="Fission.Web.Auth.Token.Types.html#Bearer"><span class="hs-identifier hs-var">Bearer</span></a></span><span> </span><span class="annot"><span class="annottext">$WToken :: JWT -&gt; RawContent -&gt; Token
</span><a href="Fission.Web.Auth.Token.Bearer.Types.html#%24WToken"><span class="hs-identifier hs-type hs-type">Bearer.Token</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Fission.Web.Client.Auth.Class.html#MonadWebAuth"><span class="hs-identifier hs-type">MonadWebAuth</span></a></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Connected.Types.html#FissionConnected"><span class="hs-identifier hs-type">FissionConnected</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ed25519.SecretKey</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-136"></span><span>  </span><span id="local-6989586621680313545"><span class="annot"><span class="annottext">getAuth :: FissionConnected SecretKey
</span><a href="#local-6989586621680313545"><span class="hs-identifier hs-var hs-var hs-var hs-var">getAuth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConnectedConfig -&gt; SecretKey) -&gt; FissionConnected SecretKey
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">ConnectedConfig -&gt; SecretKey
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AsecretKey%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">secretKey</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Fission.Authorization.ServerDID.Class.html#ServerDID"><span class="hs-identifier hs-type">ServerDID</span></a></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Connected.Types.html#FissionConnected"><span class="hs-identifier hs-type">FissionConnected</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>  </span><span id="local-6989586621680313541"><span class="annot"><span class="annottext">getServerDID :: FissionConnected DID
</span><a href="#local-6989586621680313541"><span class="hs-identifier hs-var hs-var hs-var hs-var">getServerDID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConnectedConfig -&gt; DID) -&gt; FissionConnected DID
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">ConnectedConfig -&gt; DID
</span><a href="Fission.CLI.Config.Connected.Types.html#%24sel%3AserverDID%3AConnectedConfig"><span class="hs-identifier hs-var hs-var">serverDID</span></a></span><span>
</span><span id="line-140"></span></pre></body></html>